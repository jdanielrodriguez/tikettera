<div class="container mt-4">
  <div class="row justify-content-center">
    <div class="col-xs-12 col-sm-12 col-md-12 col-lg-8 mx-auto text-left">
      <form [formGroup]="perfilForm" (ngSubmit)="onSubmit()" *ngIf="editMode; else viewMode">
        <!-- Imagen -->
        <app-imagenes (imagenPrincipal)="actualizarImagen($event)" [lista]="imagenes" carpeta="Avatar" [esAdmin]="true">
        </app-imagenes>

        <!-- Username -->
        <div class="form-group">
          <label for="username">Usuario</label>
          <input id="username" class="form-control" placeholder="Nombre de usuario" formControlName="username" />
          <div *ngIf="perfilForm.get('username')?.invalid && perfilForm.get('username')?.touched" class="text-danger">
            Usuario requerido.
          </div>
        </div>

        <!-- Email -->
        <div class="form-group">
          <label for="email">Correo Electrónico</label>
          <input id="email" type="email" class="form-control" placeholder="Correo Electrónico"
            formControlName="email" />
          <div *ngIf="perfilForm.get('email')?.invalid && perfilForm.get('email')?.touched" class="text-danger">
            Ingresa un correo electrónico válido.
          </div>
        </div>

        <!-- Names -->
        <div class="form-group">
          <label for="names">Nombre</label>
          <input id="names" class="form-control" placeholder="Nombres" formControlName="names" />
        </div>

        <!-- Lastnames -->
        <div class="form-group">
          <label for="lastnames">Apellidos</label>
          <input id="lastnames" class="form-control" placeholder="Apellidos" formControlName="lastnames" />
        </div>

        <!-- Botones -->
        <div class="row mt-3">
          <div class="col-xs-12 col-sm-12 col-md-12 col-lg-6">
            <button class="btn btn-lg btn-danger btn-block" type="button" (click)="cancelar()">Cancelar</button>
          </div>
          <div class="col-xs-12 col-sm-12 col-md-12 col-lg-6">
            <button class="btn btn-lg btn-primary btn-block" type="submit">Guardar</button>
          </div>
        </div>
      </form>

      <!-- Modo Vista -->
      <ng-template #viewMode>
        <div class="form-group">
          <label>Nombre Completo:</label>
          <p>{{ perfilForm.get('names')?.value || 'No disponible' }} {{ perfilForm.get('lastnames')?.value || '' }}</p>
        </div>
        <div class="form-group">
          <label>Usuario:</label>
          <p>{{ perfilForm.get('username')?.value || 'No disponible' }}</p>
        </div>
        <div class="form-group">
          <label>Correo Electrónico:</label>
          <p>{{ perfilForm.get('email')?.value || 'No disponible' }}</p>
        </div>
        <div class="form-group">
          <label>Imagen de Perfil:</label>
          <img *ngIf="imagenes.length > 0" [src]="imagenes[0].url" alt="Imagen de Perfil" class="img-thumbnail"
            style="max-height: 150px;" />
          <p *ngIf="imagenes.length === 0">No disponible</p>
        </div>
      </ng-template>
    </div>
  </div>
</div>
